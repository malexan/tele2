"cond";"rate";"plan";"plantype"
"plan == 'Дело чести' & !is.na(bytes)";"ceiling(bytes / 102400) * .1";"Интернет1";"option"
"plan == 'Дело чести' & str_detect(type, 'Исходящий на своего') & minutes > 0";".35 + (minutes - 1) * .25";"Дело чести";"basic"
"plan == 'Дело чести' & network == 'чужой' & minutes > 0";" ifelse(mcumsum < 31, .35 + (minutes - 1) * .25, 
ifelse(mcumsum >= 31 & lag(mcumsum) < 31, 
.35 + (minutes - 1 - 30 + lag(mcumsum)) * .25 + 
(minutes - mcumsum + 30) * .95, minutes * .95))";"Дело чести";"basic"
"plan == 'Дело чести' & type == 'Исходящий на Теле2-Россия'";"minutes * 1.5";"Дело чести";"basic"
"!is.na(seconds) & seconds <= 3 & plan == 'Дело чести' & network!='прочее'";0;"Дело чести";"basic"
"plan == 'Дело чести' & type == 'Исходящий междугор.'";"minutes * 4";"Дело чести";"basic"
"plan == 'Дело чести' & !is.na(bytes)";"ceiling(bytes / 102400) * .1";"Дело чести";"basic"
"plan == 'Дело чести' & str_detect(type, 'SMS')";0.95;"Дело чести";"basic"
"plan == 'Дело чести' & network != 'прочее'";"minutes * .35";"Оранжевый";"basic"
"plan == 'Дело чести' & !is.na(bytes)";"ceiling(bytes / 102400) * .1";"Оранжевый";"basic"
"plan == 'Дело чести' & str_detect(type, 'SMS на (своего|МТС|Билайн|Мегафон)')";0.35;"Оранжевый";"basic"
"plan == 'Дело чести' & str_detect(type, '(^SMS$)|(SMS на Теле2)')";0.95;"Оранжевый";"basic"
"plan == 'Дело чести' & type == 'Исходящий на Теле2-Россия'";1.5;"Оранжевый";"basic"
"plan == 'Дело чести' & type == 'Исходящий междугор.'";"minutes * 4";"Оранжевый";"basic"
"plan == 'БВ'";0;"БВ";"roaming"
"plan == 'Внутрисете' & type == 'Исходящий междугор.'";"minutes * 5";"Внутрисетевой";"roaming"
"plan == 'Внутрисете' & type == 'Исходящий на своего'";"minutes * 1.5";"Внутрисетевой";"roaming"
"plan == 'Внутрисете' & type == 'Исходящий на Теле2-Россия'";"minutes * 1.5";"Внутрисетевой";"roaming"
"plan == 'Внутрисете' & str_detect(type, 'SMS')";1.5;"Внутрисетевой";"roaming"
"plan == 'Дело чести' & network != 'прочее' & minutes == 0";0;"Бирюзовый";"basic"
"plan == 'Дело чести' & network != 'прочее' & minutes > 0";".55 + (minutes - 1) * .25";"Бирюзовый";"basic"
"plan == 'Дело чести' & !is.na(bytes)";"ceiling(bytes / 102400) * .1";"Бирюзовый";"basic"
"plan == 'Дело чести' & str_detect(type, 'SMS на (своего|МТС|Билайн|Мегафон)')";0.55;"Бирюзовый";"basic"
"plan == 'Дело чести' & str_detect(type, '(^SMS$)|(SMS на Теле2)')";0.95;"Бирюзовый";"basic"
"plan == 'Дело чести' & type == 'Исходящий на Теле2-Россия'";1.5;"Бирюзовый";"basic"
"plan == 'Дело чести' & type == 'Исходящий междугор.'";"minutes * 4";"Бирюзовый";"basic"
"plan == 'Дело чести' & network != 'прочее' & minutes == 0";0;"Жёлтый";"basic"
"plan == 'Дело чести' & str_detect(type, 'Исходящий на своего') & minutes > 0";0.95;"Жёлтый";"basic"
"plan == 'Дело чести' & network == 'чужой' & minutes > 0";".95 * minutes";"Жёлтый";"basic"
"plan == 'Дело чести' & !is.na(bytes)";"ceiling(bytes / 102400) * .1";"Жёлтый";"basic"
"plan == 'Дело чести' & type == 'SMS на своего'";0;"Жёлтый";"basic"
"plan == 'Дело чести' & str_detect(type, 'SMS на (МТС|Билайн|Мегафон)')";0.95;"Жёлтый";"basic"
"plan == 'Дело чести' & str_detect(type, '(^SMS$)|(SMS на Теле2)')";0.95;"Жёлтый";"basic"
"plan == 'Дело чести' & type == 'Исходящий на Теле2-Россия'";1.5;"Жёлтый";"basic"
"plan == 'Дело чести' & type == 'Исходящий междугор.'";"minutes * 4";"Жёлтый";"basic"
